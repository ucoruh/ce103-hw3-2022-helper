using Microsoft.VisualStudio.TestTools.UnitTesting;
using LibraryManagement;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LibraryManagement.Tests
{
    [TestClass()]
    public class BookTests
    {
        [TestMethod()]
        public void ByteArrayBlockToBookTest()
        {
            string sampleRecordHex =   "0000000544656D6F205469746C65203100000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000044656D6F204465736372697074696F6E" +
                                       "2031000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000044656D6F20417574686F722031000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000044656D6F20417574686F722032000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "00000000536369656E636546696374696F6E0000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "000000004472616D610000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "0000000000000000000000000000000000000000" +
                                       "00000000";

            byte[] sampleRecordBytes = ConversionUtility.ToByte(sampleRecordHex);

            Book book = Book.ByteArrayBlockToBook(sampleRecordBytes);

            //book.Id = 5;
            //book.Title = "Demo Title 1";
            //book.Description = "Demo Description 1";
            //book.Authors.Add("Demo Author 1");
            //book.Authors.Add("Demo Author 2");
            //book.Categories.Add("ScienceFiction");
            //book.Categories.Add("Drama");

            Assert.AreEqual(book.Id, 5);
            Assert.AreEqual(book.Title, "Demo Title 1");
            Assert.AreEqual(book.Description, "Demo Description 1");
            Assert.AreEqual(book.Authors.Count, 2);
            Assert.AreEqual(book.Authors[0], "Demo Author 1");
            Assert.AreEqual(book.Authors[1], "Demo Author 2");
            Assert.AreEqual(book.Categories.Count, 2);
            Assert.AreEqual(book.Categories[0], "ScienceFiction");
            Assert.AreEqual(book.Categories[1], "Drama");

        }

        [TestMethod()]
        public void BookToByteArrayBlockTest()
        {
            //Generate a book object
            Book book = new Book();

            book.Id = 5;
            book.Title = "Demo Title 1";
            book.Description = "Demo Description 1";
            book.Authors.Add("Demo Author 1");
            book.Authors.Add("Demo Author 2");
            book.Categories.Add("ScienceFiction");
            book.Categories.Add("Drama");

            //Get byte block of book object
            byte[] bookBytes = Book.BookToByteArrayBlock(book);

            string bookHex = ConversionUtility.ToHex(bookBytes);

            string expectedBookHex = "0000000544656D6F205469746C65203100000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000044656D6F204465736372697074696F6E" +
                           "2031000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000044656D6F20417574686F722031000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000044656D6F20417574686F722032000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "00000000536369656E636546696374696F6E0000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "000000004472616D610000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "0000000000000000000000000000000000000000" +
                           "00000000";

            Assert.AreEqual(expectedBookHex, bookHex);  

        }

        [TestMethod()]
        public void BookToByteArrayToBookTest()
        {
            //Generate a book object
            Book book = new Book();

            book.Id = 5;
            book.Title = "Demo Title 1";
            book.Description = "Demo Description 1";
            book.Authors.Add("Demo Author 1");
            book.Authors.Add("Demo Author 2");
            book.Categories.Add("ScienceFiction");
            book.Categories.Add("Drama");

            //Get byte block of book object
            byte[] bookBytes = Book.BookToByteArrayBlock(book);

            //Convert byte block to book object
            Book book2 = Book.ByteArrayBlockToBook(bookBytes);

            Assert.AreEqual(book2.Id, 5);
            Assert.AreEqual(book2.Title, "Demo Title 1");
            Assert.AreEqual(book2.Description, "Demo Description 1");
            Assert.AreEqual(book2.Authors.Count, 2);
            Assert.AreEqual(book2.Authors[0], "Demo Author 1");
            Assert.AreEqual(book2.Authors[1], "Demo Author 2");
            Assert.AreEqual(book2.Categories.Count, 2);
            Assert.AreEqual(book2.Categories[0], "ScienceFiction");
            Assert.AreEqual(book2.Categories[1], "Drama");
        }
    }
}